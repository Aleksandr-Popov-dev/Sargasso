-- DATABASE SCHEMA FOR SARGASSO APP
-- THIS IS STRUCTURE ONLY - NO REAL DATA OR SENSITIVE INFO
-- This schema shows table structure for educational purposes
-- DATABASE: PostgreSQL

CREATE TABLE users (
	id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
	email VARCHAR(255) NOT NULL,
	username VARCHAR(100) NOT NULL,
	fullname VARCHAR(100) NOT NULL,	
	avatar VARCHAR(255) NOT NULL,
	created_at TIMESTAMP DEFAULT NOW(),
	UNIQUE(username, email)
);

CREATE TABLE chats (
	id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
	user1_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
	user2_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
	created_at TIMESTAMP DEFAULT NOW(),
	last_message_at TIMESTAMP DEFAULT NOW(),
	UNIQUE(user1_id, user2_id)
);

CREATE TABLE chat_messages (
	id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
	chat_id UUID NOT NULL REFERENCES chats(id) ON DELETE CASCADE,
	sender_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
	content TEXT NOT NULL,
	created_at TIMESTAMP DEFAULT NOW()
);
